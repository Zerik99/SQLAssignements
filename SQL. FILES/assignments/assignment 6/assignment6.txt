/*1. Determine the total profit generated by sales to customer 1017. Note: Quantity should be reflected in the total profit calculation [i.e., (retail-cost)*quantity]. */
SELECT ordr.customer#, SUM(bks.retail - bks.cost * ordritms.quantity)as Profit
FROM orders ordr, orderitems ordritms, books bks
where ordr.customer# = '1017'
GROUP BY ordr.customer#;


/*2. Determine how many orders have been placed by each customer. Do not include in the results any customer who hasn’t recently placed an order with JustLee Books. */
SELECT cust.lastname || ', ' || cust.firstname AS name,SUM(ordritms.quantity) AS orderQTY 
FROM orderitems ordritms, customers cust
GROUP BY cust.lastname || ', ' || cust.firstname;


/*3. Determine the average retail price of books by publisher name and category. Include only the categories Children and Computer and the groups with an average retail price $50 or less. */
SELECT AVG (bks.retail) AS AVGprice, bks.category, pub.name
FROM publisher pub, books bks
WHERE bks.category IN ('COMPUTER', 'CHILDREN')
GROUP BY pub.name, bks.category
HAVING  AVG (bks.retail)<50.00 ;

/*4. What’s the retail price of the least expensive book written by Lisa White?*/
SELECT auth.lname || ', ' || auth.fname, min(bks.retail)
FROM bookauthor bka, books bks, author auth
WHERE auth.lname = 'WHITE'
AND auth.fname = 'LISA'
GROUP BY auth.lname || ', ' || auth.fname;


/*5. Determine which books generate less than a 75% profit [i.e. (retail-cost)/cost*100].  Include the book title, the book category, the number of copies sold, 
and the average book profit rounded to 2 decimal places.  Show only books with 2, 3, 4, or 5 books sold. */
